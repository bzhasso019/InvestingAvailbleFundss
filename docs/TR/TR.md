# 1. Цель проекта
Вы являетесь руководителем аналитического центра инвестиционной компании,
занимающейся вложением денежных средств в ценные бумаги.
Ваши клиенты – предприятия, которые доверяют управлять их свободными
денежными средствами на определенный период. Вам необходимо выбрать
вид ценных бумаг, которые позволят получить прибыль и компании, и
клиенту. При работе с клиентом для вас весьма существенной является
информация о предприятии – название, вид собственности, адрес и телефон.

# 2. Описание системы
### Система состоит из следующих функциональных блоков:
1. Регистрация, аутентификация и авторизация
2. Функционал для каждого пользователя
3. Функционал пополнения и снятия средств с баланса клиента
4. Реализация аналитики:
   - Краткая аналитика клиента
   - Полная аналитика клиента
5. Личный кабинет
6. Выбор клиентского портфеля, с которым будет работать сотрудник
7. История:
   - Финансовых операций со счётом
   - Купли-продажи активов
8. Купли-продажа активов(если все совсем круто будете успевать, добавим поиск по списку активов)
9. Обратная связь между пользователями

![Use-Case Диаграмма](<SaD/Use-Case Диаграмма.jpg>)

## 3. Типы пользователей
Система предусматривает четыре типа пользователей системы:

- ### 1. Неавторизированный клиент
Неавторизированный клиент имеет возможность только зарегистрироваться,
после чего он становится авторизированным клиентом. Фактически любой пользователь до входа в свой аккаунт считается 
неавторизированным клиентом.

- ### 2. Авторизированный клиент
![User-flow Схема](<./SaD/User flow схема.jpg>)

Возможности авторизованного клиента:
- Просматривать баланс
- Пополнять и снимать деньги со своего счета
- Просматривать свою историю транзакций
- Просматривать данные профиля, но не редактировать их
- Удалить аккаунт
- Просматривать аналитику портфеля(как в виде диаграммы, так и процентный рост)
- Чат

- ### 3. Сотрудник
![Employee-flow Схема](<./SaD/Employee flow схема.jpg>)

Возможности сотрудника:
- Просмотр списка всех подключенных клиентов
- Подключение клиента
- Просмотр личного профиля
- Просмотр персонального профиля пользователя
- Просмотр истории транзакций пользователя
- Просмотр списка активов
- Покупка/продажа активов на счет пользователя
- Чат

- ### 4. Админ
![Admin-flow Схема](<./SaD/Admin flow схема.jpg>)

Возможности админа:
- Просмотр списка всех пользователей
- Редактирование и создание профиля пользователя
- Блокировка пользователя
- Просмотр истории транзакций пользователя
- Просмотр списка активов
- Чат

# 4. Регистрация
## 4.1. Регистрация пользователя
Предусмотренные поля:
- Email
- Пароль
- Наименование организации
- Вид собственности
- Адрес главного офиса
- ФИО ответственного лица от организации, являющейся клиентом
- Номер телефона ответственного лица от организации, являющейся клиентами

### Возможные ошибки
- Проверка email на корректность. В случае если он отсутствует или не корректен - при попытки входа выдает ошибку: "email отсутствует или
введен некорректно".
- Пароль не меньше 8 символов, включает в себя цифры, латинские буквы
- Все поля, которые мы не можем проверить на корректность проверяются лишь на наличие данных и должны содержать не менее
трех символов и выводить ошибку, аналогичную ошибке при регистрации, но с соответствующим названием.
- ФИО должно состоять минимум из двух слов
- Номер должен начинаться с 8 или 7(тогда заменяем на 8 и проверяем) и иметь длину 11 символов. Также пользователь может
пробовать вводить данные через пробел или -. В таком случае выводится ошибка о некорректности данных. Это поле 
обязательно содержит одно слово.

Проверить email, наименование и адрес на уникальность среди сотрудников и клиентов. При обнаружении свопадении вывести 
ошибку: "Аккаунт с соответствующими данными уже существует", где будут указаные неуникальные данные

## 4.2. Регистрация сотрудника или админа
Первый админ будет вручную введен в бд и будет иметь только логин и пароль, сформированный случайным образом. Админы 
будут иметь всего один аккаунт. В его личном кабинете будет возможность зарегестрировать нового сотрудника, а также
удалить старого. Данные предоставляемы сотрудником админу для регистрации:
- Email
- ФИО
- Пароль

### Возможные ошибки
Аналогично 4.1.
- Проверка email на корректность. В случае если он отсутствует или не корректен - при попытки входа выдает ошибку: 
"email отсутствует или введен некорректно".
- Пароль не меньше 8 символов, включает в себя цифры, латинские буквы
- Проверка на уникальность

## 4.3. Аутентификация
Аутентификация пользователя осуществляется по email и паролю

## 4.4. Авторизация
При соответствии данных в бд выдаются соответствующие права и происходит переход на главную страницу пользователя

# 5. Функционал для клиента
Клиент после аутентификации (ввода логина и пароля) получает доступ к своему функционалу в системе. Этот функционал
состоит из следующих блоков:

1. Главная страница
2. Финансовый операции с балансом
3. Просмотр финансовых операций с балансом
4. Краткая аналитика
5. Расширенная аналитика
6. Личный кабинет
7. Обратная связь

## 5.1. Главная страница
В этом разделе у клиента есть возможность просмотра баланса в рублях. Сам баланс является суммой остатка средств на 
счету и совокупной стоимости активов на текущий момент. Под ним находится изменение баланса в процентах и в рублях, 
которое вычисляется на основе общей прибыли от текущих активов - стоимости активов на момент их покупки. Далее идут четыре
кнопки - пополнение, снятие средств, история финансовых операций и аналитика, выполненные в минималистичном стиле.

В правом верхнем углу личный кабинет.

В основной части страницы располагается краткая аналитика. Скролл допустим, но по возможности стоит его избежать.

В правом нижнем углу кнопка обратной связи, которая при поступлении нового сообщения должна будет изменяться, пока на
нее не нажмут.

## 5.2. Финансовые операции с балансом
К каждой обработке необходимо сохранять время операции, дату, размер операции и тип пополнение/вывод средств вносить в
бд для дальнейшего использования.

### 5.2.1. Пополнение
Пополнение осуществляется через заявку на форме, фактически никакие финансовые api мы не будем использовать, поэтому 
сумма на счету клиента просто увеличивается, а сотруднику приходит уведомление о новом поступлении на счет клиента, 
чтобы он мог распределить новые средства по активам.

### 5.2.2. Снятие
Для снятия клиенту необходимо связаться с сотрудником и запросить продать акций на определенную сумму к определенной дате.
В форме снятия отображается свободный баланс в поле введения суммы на вывод.

Кроме того запрашиваемая на вывод сумма должна быть меньше или равна сумме на балансе.

Тут ситуация аналогичная, как и с пополнением, деньги просто уходят со счета и никуда фактически не переводятся.

Предполагаемые поля:
- Размер пополнения в рублях
- Номер карты
- Чекбокс на привязку карты (см. пункт 5.2.1.)

## 5.3. Просмотр финансовых операций с балансом
При нажатии на кнопку просмотра истории под балансом, клиент переходит на другую страницу, оформленную как операции
по счету в любом банке, но записи идут монолитно и не разделяются другими записями: слева сумма изменения баланса,
справа время изменения.

## 5.4. Краткая аналитика
При рассчете диаграмм опираемся на акутальную стоимость активов, а не на их количество.

Краткая аналитика представляет из себя 2 cхемы:

1. Круговая диаграмма о процентном соотношении видов ценных бумаг в портфеле (акции, облигации, фонды, металлы, валюта)

2. Столбцовая диаграмма отражающая изменения баланса портфеля за все время его существования

## 5.5. Расширенная аналитика
Расширенная аналитика представляет из себя отдельную страницу.

Для каждого актива создан блок аналогичный краткой аналитике, несущий данные по соответствующему активу, а также выше 
выводящий суммарную стоимость соответствующего актива в портфеле. Также в верхней части страницы расположен баланс, 
соответствующий стоимости данного актива в портфеле. В расширенной аналитике по ходу реализации проекта было решено упразднить
столбцовую диаграмму.

## 5.6. Личный кабинет
ЛК представляет из себя заполненные в две колонки формы, под которыми находится краткая форма с удалением аккаунта. При
нажатии появляется дополнительная форма "Уверены ли вы" если на счете нет средств. Если на счету остались деньги, то 
форма выводит "Уверены ли вы, на Вашем счету еще есть активы, если вы сейчас удалите аккаунт, вам вернутся средства 
на одну из привязанных карт, если ни одной карты не привязано деньги будут утеряны". При подтверждении все данные
пользователя полностью стираются из бд, а пользователь переходит на страницу входа/регистрации.

## 5.7. Обратная связь
Реализуется путем общения в социальных сетях и мессенджерах.

### Дальнейшая реализация
Необходимо создать чат. При нажатии на кнопку чата он открывается и занимает примерно треть высоты и ширины страницы
(ввиду адаптивности верстки этот процент увеличивается до 100 на мобилке).

Над полем ввода формата т9 находятся 2 кнопки с прозрачным фоном, которые при наведении обретают цвет фона. При нажатии
образуется связь с бд сотрудника/поддержки, в зависимости от того, на какую кнопку нажали. Далее в поле вводится текст,
который сохраняется в бд отправителя вместе с временем оформления. Аналогичные данные поступают получателю. При открытии
данных воспроизводится история чата. Чат обновляется только при обновлении страницы. Данные отправляются только при
нажатии на соответственную кнопку.

Фактически в текущей версии клиент может общаться только с привязанным сотрудником и поддержкой(это аккаунт админа)

Допустима альтернативная реализация, но необоходимо связаться с тимлидом для внесения правок.

# 6. Функционал для сотрудника
Сотрудник после аутентификации (ввода логина и пароля) получает доступ к своему функционалу в Системе. Этот функционал
состоит из следующих блоков:

1. Главная страница
2. Привязка пользователей
3. История операций клиентов (доп задание: реализация фильтра по клиентам по ФИО)
4. Просмотр финансовых операций с балансом
5. Выбор клиентского аккаунта
6. Главная страница клиента
7. Личный кабинет
8. Обратная связь
9. История торговли
10. Торговля

## 6.1. Главная страница
В этом разделе у сотрудника есть возможность выбора клиентского аккаунта из списка, первоначально сформированного из
двух столбцов. Каждый блок - краткое ФИО клиента и аналогия баланса, реализованного у клиента, но без кнопок и
содержащая только процентное изменение баланса. Ниже идет кнопка добавлени нового клиента.

Над списком клиентов должна располагаться кнопка для просмотра истории операций клиентов.

В правом верхнем углу личный кабинет.

В правом нижнем углу кнопка обратной связи, которая при поступлении нового сообщения должна будет изменяться, пока на
нее не нажмут.

## 6.2. Привязка пользователей
При нажатии на кнопку добавления клиента появляется форма. В ней необходимо указать email клиента, который в дальнейшем
будет в списке клиентов, на аккаунте которых сотрудник способен торговать.

## 6.3. История операций клиентов
Аналогично пункту 5.3., однако история должна быть сформированна из действий абсолютно всех клиентов, к которым
подключен сотрудник.

## 6.4. Просмотр финансовых операций с балансом
Аналогично клиентской версии, но для выводятся данные только выбранного клиента.

## 6.5. Выбор клиентского аккаунта
В середине главной страницы должен располагаться список из клиентов, к которым подключен сотрудник. 
Далее сотрудник попадает "на аккаунт клиента", с единственным отличием в кнопке каталога активов.

## 6.6. Главная страница клиента
Основано на 5.1.
Различия в реализации:

1. ЛК переходит на сотрудника
2. Отсутствуют операции с изменением количества средств на балансе
3. Появляется кнопочка торговли
4. Появляется кнопка выхода из этого аккаунта. Реализация и размещение на усмотрение 
дизайнера

## 6.7. Личный кабинет
Абсолютно аналогично пользователю, за исключением возможности удаления аккаунта, в бд различаем права доступа при
помощи дополнительной записи. Отображаемые данные: email и ФИО.

## 6.8. Обратная связь
Аналогично клиенту.

### Дальнейшая реализация
Чат должен работать для каждого подключенного клиента.

## 6.9. История торговли
При нажатии на кнопку просмотра истории под балансом, сотрудник переходит на другую страницу, оформленную как история
операций с портфелем(пример ниже), но записи идут монолитно и не разделяются другими записями: слева img_logo,
название актива, сумма изменения баланса, справа время изменения.

## 6.10. Торговля
После нажатия на кнопку каталога пользователь переходит в список активов, где он может выбрать один из 5 доступных видов
активов:

1. Акции
2. Облигации
3. Фонды
4. Металлы и валюты

После выбора вида активов появляется список из активов, где каждый блок имеет следующий вид:
тикер, название актива, стоимость, изменение цены в течении определенного периода времени.

Список активов:

1. Акции

- Лукойл
- Сбер
- ГК Самолёт
- Магнит
- Positive Technologies
- Novabev Group
- Ozon
- ФосАгро
- АЛРОСА
- Мать и дитя

2. Облигации

- ОФЗ 26238
- ОФЗ 26243
- ОФЗ 26225
- О'КЕЙ 001P-06
- Делимобиль 1Р-03
- М. Видео выпуск 3
- ВИС Финанс выпуск 1
- Газпром Капитал БЗО26-1-Е
- ГТЛК ЗО28рД

3. Фонды

- Тинькофф Вечный портфель
- Тинькофф Золото
- Тинькофф IMOEX
- ВИМ Ликвидность
- ВИМ Фонд Золото
- ВИМ Индекс Московской биржи
- Альфа-Капитал Управление
- Альфа-Капитал Золото
- АТОН Российские акции

4. Металлы и валюта

- Золото
- Серебро
- Доллар США
- Евро
- Китайский юань
- Гонконгский доллар
- Турецкая лира

При нажатии на соответствующий актив, сотрудник переходит на страницу торговли. В центре находится график, под ним 2 кнопки: купить и продать. Между ними количество акций, выбранное для данных действий. Над этим полем расположенно текущее количество приобретенных активов и процент доходности. Если активы отсутствуют, запись также будет отсутствовать(упрощенная реализация - пусть будет 0 акций).

При продаже в бд уменьшается количество акций, приобретенных на данный момент.
При покупке считается средняя стоимость 1 единицы актива на данный момент и заменяет эту запись в бд.

Должна осуществляться проверка, хвататет ли средств на балансе пользователя для совершения транзакции.

Кроме того, при совершении транзакции необходим вычет комиссии биржи(0.04%), а также нашей комиссии при продаже, которая составляет 25% от чистой прибыли сделки.

# 7. Функционал для админа

Админ после аутентификации (ввода логина и пароля) получает доступ к
своему функционалу в системе. Этот функционал состоит из
следующих блоков:

1. Главная страница
2. Личный кабинет админа
3. Выбор пользовательского аккаунта
4. Главная страница пользователя
5. Просмотр истории изменения баланса
6. История торговли
7. Личный кабинет пользователя
8. Каталог приобретенных активов
9. Обратная связь
10. Создание аккаунта сотрудника

## 7.1. Главная страница

Схоже с 6.1

В этом разделе у админа есть возможность выбора пользовательского аккаунта из списка, первоначально сформированного из 
двух столбцов. Слева клиента, справа сотрудники. В мобильной версии сначала список клиентов, отступ, список сотрудников.
Для каждого пользователя достаточно вывести его ФИО. Дизайнеру желательно разделить цветом сотрудника и клиента.

В правом верхнем углу личный кабинет админа.

В правом нижнем углу кнопка обратной связи, которая при поступлении нового сообщения должна будет изменяться, пока на 
нее не нажмут.

## 7.2. Личный кабинет админа

Аналогично другим, но с возможностью редактировать данные и создавать аккаунты сотрудников.

## 7.3. Выбор пользовательского аккаунта

В середине главной страницы должен располагаться список из пользователей, к которым подключен админ.
Должна присутствовать привязка аккаунта аналогичная в 6.2., либо все созданные пользователи должны автоматически добавляться
в этот список. Решение команды разработчиков ожидаю в лс.
Далее админ попадает "на аккаунт пользователя". 

## 7.4. Главная страница пользователя

Основано на 5.1. или 6.1
2 кнопки лк: одна админа, другая пользователя. История изменения баланса, история торговли. Аналитику и все 
остальное опускаем

## 7.5. Просмотр финансовых операций с балансом

Аналогично клиентской версии

## 7.6 История торговли

Аналогично версии для сотрудника

## 7.7 Личный кабинет

Абсолютно аналогично пользователю, однако есть возможность редактирования информации и удаления его аккаунта

## 7.8 Каталог приобретенных активов

Список из имеющихся у клиента активов, реализованных ввиде списка из блоков для каждого вида активов. Данный список будет иметь структуру близкую с каталогом при приобретении сотрудником активов. Для наглядности необходим дизайнер.

## 7.9. Обратная связь

Аналогично 6.8.

## 7.10. Создание аккаунта сотрудника

В ЛК есть возможность создания нового аккаунта сотрудника. При ее нажатии админ вводит почту, ФИО и
пароль для нового аккаунта, который автоматически привязывается к аккаунту админа(новый аккаунт админа не привязывается).

# 8. Предлагаемый стек технологий
Для реализации системы предлагается следующий стек технологий:

- Бэкенд:
  - Язык Python
  - Фреймворк Django
  - БД PostgreSQL
- Фронтенд:
  - JavaScript

# 9. Требования к дизайну
Минимализм, лаконичность, акцент на контент. Черный фон. Должен присутствовать логотип Системы где-то на странице.
Логотип надо разработать в рамках этого проекта.

# 10. Реализованный дизайн
Макет находится по данной ссылке:  
<https://www.figma.com/design/I1dnOGPMK6I7Go0m8KbdHY/Баблос?node-id=0-1>

# 11. Будущие введения, а также улучшения
- Появится возможность автоматически вводить данные карты на основе ранее введенных.
- Кнопка, позволяющая вывести все средства.
- Отображение свободного баланса над полем ввода суммы средств на вывод.
- Внутренний чат.
- Создание отдельной формы в снятии для осведомлении сотрудника о необходимости освобождения определенного числа средств
с автоматическим уведомлением админа(все этого реализуется внутри ранее упомянутого чата).
- Подключение электронных кошельков и реализация перевода всего остатка средств в случае с удалением клиентского аккаунта
в пользу компании.
- Кнопка отвязки аккаунта клиента у сотрудника.
- Возможность выбора периода для оценки в аналитике и торговле.
- Оптимизация работы бд для больших мощностей.
- Оптимизация торговли для улучшения удобства работы.
- Возможность админа попасть в личный кабинет сотрудника.
